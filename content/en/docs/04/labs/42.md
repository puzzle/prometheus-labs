---
title: "4.2 Tasks: Pushgateway"
weight: 2
sectionnumber: 4.2
---

### Task {{% param sectionnumber %}}.1 - Install and configure

**Task description**:

* Configure Prometheus to scrape the metrics from the Pushgateway

{{% details title="Hints" mode-switcher="normalexpertmode" %}}

Prometheus `scrape_config`

```yaml
scrape_configs:
  - job_name: 'pushgateway'
    honor_labels: true
    static_configs:
      - targets: ['localhost:9091']
```

Reload Prometheus

```bash
sudo systemctl restart prometheus
```

{{% /details %}}

### Task {{% param sectionnumber %}}.2 - Push metrics

**Task description**:

* Push the following metric to the Pushgateway and make sure the metric gets scraped by Prometheus

```promql
# TYPE some_metric_total counter
# HELP This is just an example metric.
some_metric_total{job="promtheus_training",instance="myinstance"} 42
```

{{% details title="Hints" mode-switcher="normalexpertmode" %}}

```bash
cat <<EOF | curl --data-binary @- http://localhost:9091/metrics/job/pushgw/instance/example_instance
# TYPE some_metric_total counter
# HELP This is just an example metric.
some_metric_total 42
EOF
```

Verify: [http://LOCALHOST:9090/graph?g0.range_input=1h&g0.expr=some_metric_total&g0.tab=1](http://LOCALHOST:9090/graph?g0.range_input=1h&g0.expr=some_metric_total&g0.tab=1)

If you see the labels `exported_instance` and `exported_job` in the Prometheus expression browser you did not set `honor_labels: true` in the Pushgateway scrape configuration.
{{% /details %}}

### Task {{% param sectionnumber %}}.3 - Delete metrics

**Task description**:

* Delete all metrics from the Pushgateway

{{% details title="Hints" mode-switcher="normalexpertmode" %}}

Deleting metrics requires the cli option `--web.enable-admin-api`

```bash
curl -X PUT http://localhost:9091/api/v1/admin/wipe
```

It is also possible to delete only metrics with specific job or instance labels. Please refer to the [upstream documentation](https://github.com/prometheus/pushgateway) for more examples.

{{% /details %}}
